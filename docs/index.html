<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://unpkg.com/maplibre-gl@5.6.1/dist/maplibre-gl.js"></script>
<link href="https://unpkg.com/maplibre-gl@5.6.1/dist/maplibre-gl.css" rel="stylesheet" />
<style>
body { margin: 0; background: #000; font-family: Arial, sans-serif; } 
#map { width: 100vw; height: 100vh; }
#properties-panel {
  position: fixed;
  top: 0;
  right: 0;
  width: 350px;
  height: 100vh;
  background: rgba(255, 255, 255, 0.9);
  border-left: 1px solid #ccc;
  overflow-y: auto;
  padding: 15px;
  box-sizing: border-box;
  display: none;
  z-index: 1000;
}
#properties-panel h3 {
  margin: 0 0 10px 0;
  color: #333;
  font-size: 16px;
}
.feature-item {
  margin-bottom: 15px;
  border: 1px solid #ddd;
  border-radius: 4px;
  background: white;
}
.feature-header {
  padding: 8px 12px;
  background: #f5f5f5;
  border-bottom: 1px solid #ddd;
  cursor: pointer;
  font-weight: bold;
  font-size: 14px;
}
.feature-header:hover {
  background: #eee;
}
.feature-properties {
  padding: 10px 12px;
  font-family: monospace;
  font-size: 12px;
  white-space: pre-wrap;
  word-break: break-word;
  max-height: 200px;
  overflow-y: auto;
}
.feature-properties.collapsed {
  display: none;
}
#close-panel {
  position: absolute;
  top: 10px;
  right: 15px;
  background: none;
  border: none;
  font-size: 18px;
  cursor: pointer;
  color: #666;
}
#close-panel:hover {
  color: #000;
}
</style>
</head>
<body>
<div id="map"></div>
<div id="properties-panel">
  <button id="close-panel">&times;</button>
  <h3>Feature Properties</h3>
  <div id="properties-content"></div>
</div>
<script>
const style = {
    "version": 8,
    "sources": {
        "protomaps": {
            "type": "vector",
            "attribution": "<a href=\"https://github.com/protomaps/basemaps\">Protomaps</a> Â© <a href=\"https://openstreetmap.org\">OpenStreetMap</a>",
            "url": "https://tunnel.optgeo.org/martin/protomaps-basemap"
        }
    },
    "layers": [
        {
            "id": "background",
            "type": "background",
            "paint": {
                "background-color": "#cccccc"
            }
        },
        {
            "id": "earth",
            "type": "fill",
            "filter": [
                "==",
                "$type",
                "Polygon"
            ],
            "source": "protomaps",
            "source-layer": "earth",
            "paint": {
                "fill-color": "#e2dfda"
            }
        },
        {
            "id": "landcover",
            "type": "fill",
            "source": "protomaps",
            "source-layer": "landcover",
            "paint": {
                "fill-color": [
                    "match",
                    [
                        "get",
                        "kind"
                    ],
                    "grassland",
                    "rgba(210, 239, 207, 1)",
                    "barren",
                    "rgba(255, 243, 215, 1)",
                    "urban_area",
                    "rgba(230, 230, 230, 1)",
                    "farmland",
                    "rgba(216, 239, 210, 1)",
                    "glacier",
                    "rgba(255, 255, 255, 1)",
                    "scrub",
                    "rgba(234, 239, 210, 1)",
                    "rgba(196, 231, 210, 1)"
                ],
                "fill-opacity": [
                    "interpolate",
                    [
                        "linear"
                    ],
                    [
                        "zoom"
                    ],
                    5,
                    1,
                    7,
                    0
                ]
            }
        },
        {
            "id": "landuse_park",
            "type": "fill",
            "source": "protomaps",
            "source-layer": "landuse",
            "filter": [
                "in",
                "kind",
                "national_park",
                "park",
                "cemetery",
                "protected_area",
                "nature_reserve",
                "forest",
                "golf_course",
                "wood",
                "nature_reserve",
                "forest",
                "scrub",
                "grassland",
                "grass",
                "military",
                "naval_base",
                "airfield"
            ],
            "paint": {
                "fill-opacity": [
                    "interpolate",
                    [
                        "linear"
                    ],
                    [
                        "zoom"
                    ],
                    6,
                    0,
                    11,
                    1
                ],
                "fill-color": [
                    "case",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "national_park",
                                "park",
                                "cemetery",
                                "protected_area",
                                "nature_reserve",
                                "forest",
                                "golf_course"
                            ]
                        ]
                    ],
                    "#9cd3b4",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "wood",
                                "nature_reserve",
                                "forest"
                            ]
                        ]
                    ],
                    "#a0d9a0",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "scrub",
                                "grassland",
                                "grass"
                            ]
                        ]
                    ],
                    "#99d2bb",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "glacier"
                            ]
                        ]
                    ],
                    "#e7e7e7",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "sand"
                            ]
                        ]
                    ],
                    "#e2e0d7",
                    [
                        "in",
                        [
                            "get",
                            "kind"
                        ],
                        [
                            "literal",
                            [
                                "military",
                                "naval_base",
                                "airfield"
                            ]
                        ]
                    ],
                    "#c6dcdc",
                    "#e2dfda"
                ]
            }
        },
        {
            "id": "water",
            "type": "fill",
            "filter": [
                "==",
                "$type",
                "Polygon"
            ],
            "source": "protomaps",
            "source-layer": "water",
            "paint": {
                "fill-color": "#80deea"
            }
        },
        {
            "id": "roads_highway",
            "type": "line",
            "source": "protomaps",
            "source-layer": "roads",
            "filter": [
                "all",
                [
                    "!has",
                    "is_tunnel"
                ],
                [
                    "!has",
                    "is_bridge"
                ],
                [
                    "==",
                    "kind",
                    "highway"
                ],
                [
                    "!has",
                    "is_link"
                ]
            ],
            "paint": {
                "line-color": "#ffffff",
                "line-width": [
                    "interpolate",
                    [
                        "exponential",
                        1.6
                    ],
                    [
                        "zoom"
                    ],
                    3,
                    0,
                    6,
                    1.1,
                    12,
                    1.6,
                    15,
                    5,
                    18,
                    15
                ]
            }
        },
        {
            "id": "roads_major",
            "type": "line",
            "source": "protomaps",
            "source-layer": "roads",
            "filter": [
                "all",
                [
                    "!has",
                    "is_tunnel"
                ],
                [
                    "!has",
                    "is_bridge"
                ],
                [
                    "==",
                    "kind",
                    "major_road"
                ]
            ],
            "paint": {
                "line-color": "#ffffff",
                "line-width": [
                    "interpolate",
                    [
                        "exponential",
                        1.6
                    ],
                    [
                        "zoom"
                    ],
                    6,
                    0,
                    12,
                    1.6,
                    15,
                    3,
                    18,
                    13
                ]
            }
        },
        {
            "id": "boundaries",
            "type": "line",
            "source": "protomaps",
            "source-layer": "boundaries",
            "paint": {
                "line-color": "#adadad",
                "line-width": 0.4,
                "line-dasharray": [2, 1]
            }
        },
        {
            "id": "places_locality",
            "type": "symbol",
            "source": "protomaps",
            "source-layer": "places",
            "filter": [
                "==",
                "kind",
                "locality"
            ],
            "layout": {
                "text-field": ["get", "name"],
                "text-font": ["Noto Sans Regular"],
                "text-size": 12
            },
            "paint": {
                "text-color": "#5c5c5c",
                "text-halo-color": "#e0e0e0",
                "text-halo-width": 1
            }
        }
    ],
    "sprite": "https://protomaps.github.io/basemaps-assets/sprites/v4/light",
    "glyphs": "https://protomaps.github.io/basemaps-assets/fonts/{fontstack}/{range}.pbf"
}

const map = new maplibregl.Map({
  container: 'map', hash: true, style: style
});
map.addControl(new maplibregl.NavigationControl());
map.addControl(new maplibregl.GlobeControl());

// Property display functionality
const propertiesPanel = document.getElementById('properties-panel');
const propertiesContent = document.getElementById('properties-content');
const closeButton = document.getElementById('close-panel');

// Close panel functionality
closeButton.addEventListener('click', () => {
  propertiesPanel.style.display = 'none';
});

// Map click handler for feature properties
map.on('click', (e) => {
  const features = map.queryRenderedFeatures(e.point);
  
  if (features.length > 0) {
    displayFeatureProperties(features);
    propertiesPanel.style.display = 'block';
  }
});

function displayFeatureProperties(features) {
  propertiesContent.innerHTML = '';
  
  features.forEach((feature, index) => {
    const featureDiv = document.createElement('div');
    featureDiv.className = 'feature-item';
    
    // Feature header
    const header = document.createElement('div');
    header.className = 'feature-header';
    const layerName = feature.layer ? feature.layer.id : 'Unknown Layer';
    const featureType = feature.geometry ? feature.geometry.type : 'Unknown';
    header.textContent = `${layerName} (${featureType})`;
    
    // Properties content
    const propsDiv = document.createElement('div');
    propsDiv.className = 'feature-properties';
    propsDiv.textContent = JSON.stringify(feature.properties, null, 2);
    
    // Toggle functionality
    header.addEventListener('click', () => {
      propsDiv.classList.toggle('collapsed');
    });
    
    featureDiv.appendChild(header);
    featureDiv.appendChild(propsDiv);
    propertiesContent.appendChild(featureDiv);
  });
}

</script>
</body>
</html>